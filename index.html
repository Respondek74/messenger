<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Canyon Messenger 2029</title>
    
    <script defer src="https://cloud.umami.is/script.js" data-website-id="dd92207d-a0ed-4644-af2d-d4fa2500f7f8"></script>

    <style>
        :root {
            --bg-black: #000000;
            --header-dark: #121212;
            --text-white: #ffffff;
            --text-gray: #8e8e93;
            --accent-blue: #007aff;
            --border-gray: #262626;
            --message-bot: #1c1c1e;
            --message-user: #007aff;
            --input-bg: #1c1c1e;
            --canyon-dark-blue: #01326F;
        }

        body, html {
            margin: 0; padding: 0; height: 100%; height: 100dvh; 
            background-color: var(--bg-black);
            color: var(--text-white);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
            -webkit-tap-highlight-color: transparent;
            overflow: hidden;
            position: fixed;
            width: 100%;
        }

        /* --- App Layout --- */
        .app-container { display: flex; flex-direction: column; height: 100%; width: 100%; position: relative; visibility: hidden; }
        .app-container.visible { visibility: visible; }

        /* --- Overlays --- */
        #intro-overlay, #browser-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; display: none; flex-direction: column; }
        #intro-overlay { background-color: var(--bg-black); align-items: center; justify-content: center; transition: opacity 1.2s, visibility 1.2s; }
        #intro-overlay.active { display: flex; }
        #intro-overlay.fade-out { opacity: 0; visibility: hidden; }

        #browser-overlay { background: rgba(0,0,0,0.95); z-index: 2000; animation: slideUp 0.4s; justify-content: center; align-items: center; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        #browser-iframe { width: 100%; height: 100%; border: none; background: white; display: none; }
        #overlay-image { max-width: 95%; max-height: 90%; object-fit: contain; display: none; }
        
        .close-overlay-btn {
            position: absolute; top: calc(25px + env(safe-area-inset-top)); right: 20px;
            width: 44px; height: 44px; background: #333333; color: white; border-radius: 50%; 
            border: 1.5px solid rgba(255,255,255,0.3); font-size: 22px; display: flex; 
            align-items: center; justify-content: center; cursor: pointer; z-index: 2100;
        }

        header {
            background-color: var(--bg-black);
            padding: calc(15px + env(safe-area-inset-top)) 0 15px 0;
            border-bottom: 0.5px solid var(--border-gray);
            z-index: 10; display: flex; justify-content: center; align-items: center; flex-shrink: 0;
        }
        .header-logo-container { height: 18px; width: auto; }
        .header-logo-container svg { height: 100%; width: auto; fill: white; display: block; }

        .view-wrapper { flex: 1; position: relative; width: 100%; overflow: hidden; }

        .view {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-black); display: flex; flex-direction: column;
        }
        
        #listView { z-index: 5; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        #detailView { z-index: 6; transform: translateX(100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); display: none; }
        .view-active { transform: translateX(0) !important; display: flex !important; }

        /* Avatars */
        .avatar { width: 52px; height: 52px; border-radius: 50%; margin-right: 15px; display: flex; align-items: center; justify-content: center; font-weight: 600; flex-shrink: 0; overflow: hidden; }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }

        .chat-item { display: flex; padding: 14px 16px; align-items: center; border-bottom: 0.5px solid var(--border-gray); cursor: pointer; }
        .chat-preview { flex: 1; min-width: 0; }
        .chat-preview-top { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 2px; }
        .name { font-weight: 600; font-size: 16px; color: var(--text-white); }
        .chat-list-time { font-size: 12px; color: var(--text-gray); }
        .sub { color: var(--text-gray); font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        .chat-detail-header { padding: 10px 15px; background: var(--header-dark); display: flex; align-items: center; border-bottom: 0.5px solid var(--border-gray); flex-shrink: 0; }
        .back-btn { font-size: 30px; color: var(--accent-blue); padding-right: 15px; cursor: pointer; }
        .message-area { flex: 1; padding: 15px; display: flex; flex-direction: column; gap: 8px; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        
        .msg-wrapper { display: flex; flex-direction: column; max-width: 85%; animation: msgIn 0.3s ease-out; margin-bottom: 2px; }
        @keyframes msgIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .bot { align-self: flex-start; }
        .user { align-self: flex-end; }
        .msg { padding: 10px 14px; border-radius: 18px; font-size: 15px; line-height: 1.4; }
        .bot .msg { background: var(--message-bot); }
        .user .msg { background: var(--message-user); }
        .timestamp { font-size: 10px; color: var(--text-gray); margin-top: 4px; padding: 0 5px; }

        .chat-img-bubble { max-width: 240px; border-radius: 15px; overflow: hidden; margin: 5px 0; border: 0.5px solid var(--border-gray); flex-shrink: 0; }
        .media-card { background: var(--message-bot); border-radius: 12px; overflow: hidden; margin: 5px 0; border: 0.5px solid var(--border-gray); max-width: 280px; height: 240px; flex-shrink: 0; }
        .media-img { width: 100%; height: 140px; background: #f2e6e6 url('ft-cover.png') no-repeat center center; background-size: cover; }
        .media-info { padding: 12px; font-size: 13px; line-height: 1.4; }

        .input-area {
            background: var(--header-dark); 
            padding: 10px 15px calc(15px + env(safe-area-inset-bottom)) 15px;
            border-top: 0.5px solid var(--border-gray); 
            display: flex; align-items: center; gap: 10px; flex-shrink: 0;
        }
        .input-field-container { flex: 1; background: var(--input-bg); border-radius: 22px; padding: 10px 18px; }
        .input-field { border: none; background: transparent; color: var(--text-white); font-size: 16px; width: 100%; outline: none; }
        .send-btn { width: 36px; height: 36px; background: var(--accent-blue); border-radius: 50%; border: none; display: flex; align-items: center; justify-content: center; }
        .send-btn:disabled { opacity: 0.3; }
        
        .typing { font-size: 12px; color: var(--text-gray); margin: 5px 0 0 15px; font-style: italic; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div id="browser-overlay">
    <button class="close-overlay-btn" onclick="closeOverlay()">‚úï</button>
    <iframe id="browser-iframe" src=""></iframe>
    <img id="overlay-image" src="" alt="Zoom Image">
</div>

<div id="intro-overlay">
    <div class="logo-container">
        <svg version="1.1" class="canyon-svg" viewBox="0 0 1024 144" xmlns="http://www.w3.org/2000/svg"><path d="M25.395,1.187c-29.314,0-34.205,24.226-9.661,54.105l41.547,50.386c14.962,18.172,28.737,32.367,34.855,37.182 c0.169,0.129,0.336,0.18,0.582,0.18h42.101c-14.417-9.213-31.878-26.022-44.59-40.765L43.286,45.888 c-10.001-12.171-8.335-18.653,3.262-17.075c5.853,0.796,21.905,8.591,39.55,24.83h36.195C94.022,21.834,61.046,1.187,25.395,1.187"/><path d="M150.207,144.215h28.946c-1.413-11.015-6.277-23.98-16.313-36.063h-31.816C142.457,121.96,147.63,132.572,150.207,144.215"/><polyline points="635.381,105.377 589.001,4.065 560.189,4.065 594.771,73.428 593.829,73.418 501.408,4.065 460.456,4.065 605.27,111.18 633.093,144.188 668.105,144.188 635.381,105.377"/><polyline points="378.444,4.065 492.015,137.139 491.065,137.125 325.646,4.065 292.143,4.065 408.71,143.002 442.006,143.002 373.844,67.492 374.788,67.492 469.324,144.188 527.214,144.188 409.659,4.065 378.444,4.065"/><polyline points="875.228,4.065 988.803,137.139 987.853,137.125 822.423,4.065 788.905,4.065 905.503,143.002 938.777,143.002 871.859,67.492 871.569,67.492 966.105,144.188 1024,144.188 906.421,4.065 875.228,4.065"/><polyline points="163.511,4.065 235.119,143.008 264.936,143.008 210.593,41.637 211.512,41.637 316.461,144.188 354.064,144.188 207.5,4.065 163.511,4.065"/><path d="M740.176,102.202c12.736,14.765,30.229,31.595,44.652,40.8H742.68c-0.247,0-0.416-0.035-0.589-0.161 c-6.134-4.831-19.918-19.049-34.906-37.224l-41.587-50.439C641.017,25.257,645.919,1,675.264,1 c38.451,0,73.806,23.99,103.477,60.077l21.449,26.074c20.326,24.688,26.599,39.927,29.647,57.037h-27.56 c-2.594-11.646-7.771-22.271-19.208-36.092l-30.394-36.981c-23.372-28.343-48.561-41.403-56.249-42.449 c-11.586-1.572-13.254,4.914-3.254,17.099L740.176,102.202"/></svg>
    </div>
    <div class="intro-text">In einer nicht allzu fernen Zukunft...</div>
    <div class="loader-container"><div id="loader-bar" class="loader-bar"></div></div>
</div>

<div id="app-container" class="app-container">
    <header>
        <div class="header-logo-container">
            <svg version="1.1" viewBox="0 0 1024 144" xmlns="http://www.w3.org/2000/svg"><path d="M25.395,1.187c-29.314,0-34.205,24.226-9.661,54.105l41.547,50.386c14.962,18.172,28.737,32.367,34.855,37.182 c0.169,0.129,0.336,0.18,0.582,0.18h42.101c-14.417-9.213-31.878-26.022-44.59-40.765L43.286,45.888 c-10.001-12.171-8.335-18.653,3.262-17.075c5.853,0.796,21.905,8.591,39.55,24.83h36.195C94.022,21.834,61.046,1.187,25.395,1.187"/><path d="M150.207,144.215h28.946c-1.413-11.015-6.277-23.98-16.313-36.063h-31.816C142.457,121.96,147.63,132.572,150.207,144.215"/><polyline points="635.381,105.377 589.001,4.065 560.189,4.065 594.771,73.428 593.829,73.418 501.408,4.065 460.456,4.065 605.27,111.18 633.093,144.188 668.105,144.188 635.381,105.377"/><polyline points="378.444,4.065 492.015,137.139 491.065,137.125 325.646,4.065 292.143,4.065 408.71,143.002 442.006,143.002 373.844,67.492 374.788,67.492 469.324,144.188 527.214,144.188 409.659,4.065 378.444,4.065"/><polyline points="875.228,4.065 988.803,137.139 987.853,137.125 822.423,4.065 788.905,4.065 905.503,143.002 938.777,143.002 871.859,67.492 871.569,67.492 966.105,144.188 1024,144.188 906.421,4.065 875.228,4.065"/><polyline points="163.511,4.065 235.119,143.008 264.936,143.008 210.593,41.637 211.512,41.637 316.461,144.188 354.064,144.188 207.5,4.065 163.511,4.065"/><path d="M740.176,102.202c12.736,14.765,30.229,31.595,44.652,40.8H742.68c-0.247,0-0.416-0.035-0.589-0.161 c-6.134-4.831-19.918-19.049-34.906-37.224l-41.587-50.439C641.017,25.257,645.919,1,675.264,1 c38.451,0,73.806,23.99,103.477,60.077l21.449,26.074c20.326,24.688,26.599,39.927,29.647,57.037h-27.56 c-2.594-11.646-7.771-22.271-19.208-36.092l-30.394-36.981c-23.372-28.343-48.561-41.403-56.249-42.449 c-11.586-1.572-13.254,4.914-3.254,17.099L740.176,102.202"/></svg>
        </div>
    </header>

    <div class="view-wrapper">
        <div id="listView" class="view"><div id="chat-list-content"></div></div>
        
        <div id="detailView" class="view">
            <div class="chat-detail-header">
                <span class="back-btn" onclick="closeChat()">‚Äπ</span>
                <div id="detail-avatar" class="avatar" style="width:36px; height:36px; font-size:14px; margin-right:10px;"></div>
                <strong id="detail-name">Partner</strong>
            </div>
            <div id="message-area" class="message-area"></div>
            <div id="typing-box" class="typing hidden">schreibt...</div>
            
            <div class="input-area">
                <div class="input-field-container">
                    <input type="text" id="chat-input" class="input-field" readonly placeholder="Antwort...">
                </div>
                <button id="send-btn" class="send-btn" disabled>
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="white"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                </button>
            </div>
        </div>
    </div>
</div>

<audio id="voice-audio"></audio>

<script>
    const chatData = [
      {
        "id": 10, "name": "Rudi Rider", "initial": "R", "color": "#94a3b8", "sub": "‚ù§Ô∏è Neues Aeroad", "img": "rudi.png",
        "initialMessages": [
            "Hi Roman, mein neues Aeroad kam an. Euer Bike Fitting Service begeistert!",
            "SHOW_PRODUCT_IMAGE",
            "Stack und Reach passen perfekt. Das ist Perfektion."
        ],
        "options": [{ "t": "Genau das war der Plan: Ein System, das den Rider perfekt kennt. Danke f√ºr deine Treue!", "r": "Beratung wie fr√ºher in der Garage ‚Äì nur digital. üì∏" }]
      },
      {
        "id": 7, "name": "Sarah", "initial": "S", "color": "#8b5cf6", "sub": "Community Managerin", "img": "sarah.png",
        "initialMessages": ["Roman! NPS auf Rekordhoch. üìà", "KI l√∂st Standard-Themen und wir haben Zeit f√ºr echte Geschichten."],
        "options": [{ "t": "Genau, also wie immer: Schick mir Montag die kritischen Stimmen.", "r": "Keine Sorge, die Montags-Runde bleibt heilig. üòâ" }]
      },
      {
        "id": 6, "name": "Rad Race", "initial": "RR", "color": "#10b981", "sub": "Best Canyon Service", "img": "radrace.png",
        "initialMessages": ["Hey Roman, mega, was ihr erreicht habt!", "Es macht richtig Spa√ü mit euch zu arbeiten."],
        "options": [{ "t": "Super, freut mich!", "r": "'Pure Cycling' bis in die letzte Schraube." }]
      },
      {
        "id": 2, "name": "GBL Stratege", "initial": "GS", "color": "#ef4444", "sub": "Turn-Around", "img": "gbl.png",
        "initialMessages": ["Gl√ºckwunsch zum Turn-Around! ü•Ç", "Die Entscheidungen 2026 waren richtig.", "Press: Future Times (Picture embedded)"],
        "options": [{ "t": "Danke!", "r": "Lass uns diesen Weg gemeinsam weitergehen!" }]
      },
      {
        "id": 1, "name": "Mathieu", "initial": "M", "color": "#ffffff", "textColor": "#01326F", "sub": "Unser Weltmeister üåà", "img": "mathieu.png",
        "initialMessages": ["Hey Roman! üåà N√§chster Titel... Wahnsinn."],
        "options": [{ "t": "Gl√ºckwunsch!", "r": "Tolle Teamleistung." }]
      },
      {
        "id": 5, "name": "LeBron James", "initial": "LJ", "color": "#f59e0b", "sub": "LBJ Legacy Bike", "img": "lebron.png",
        "initialMessages": ["Yo Roman! üèÄ R126 has gone live!"],
        "options": [{ "t": "Fantastic!", "r": "Me too, Roman." }]
      },
      {
        "id": 9, "name": "CFO", "initial": "CF", "color": "#64748b", "sub": "TCO & Margen", "img": "cfo.png",
        "initialMessages": ["Morgen Roman. TCO auf Rekordtief. üìâ"],
        "options": [{ "t": "Weniger Silos = mehr Freiheit.", "r": "Ich hab's dir immer gesagt." }]
      },
      {
        "id": 3, "name": "Thilo Kerner (Sybit)", "initial": "TK", "color": "#C300FF", "textColor": "#ffffff", "sub": "CX Champions", "img": "thilo.png",
        "initialMessages": ["Morgen Roman!", "Stolz auf unsere Ergebnisse."],
        "options": [{ "t": "Datenschatz gehoben.", "r": "üíú Lass uns telefonieren: <a href='tel:+491752957364'>+49 1752 957364</a>." }]
      },
      {
        "id": 4, "name": "Marketing Team", "initial": "MT", "color": "#ec4899", "sub": "üé§ Sprachnachricht", "img": "marketing.png", "isVoice": true,
        "voiceTxt": "Hi Roman! WOW!",
        "initialMessages": ["üé§ Sprachnachricht empfangen"],
        "options": [{ "t": "Data is king!", "r": "Echte Loyalit√§t!" }]
      },
      {
        "id": 8, "name": "Shanghai Store", "initial": "SH", "color": "#3b82f6", "sub": "Skalierung Asien", "img": "shanghai.png",
        "initialMessages": ["Gr√º√üe aus Shanghai! üá®üá≥"],
        "options": [{ "t": "Ein wichtiger Hebel.", "r": "Absolut!" }]
      }
    ];

    const audioPlayer = document.getElementById('voice-audio');

    function getTimestamp() {
        const now = new Date();
        return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')} (18.02.2029)`;
    }

    function startApp() {
        const intro = document.getElementById('intro-overlay');
        const bar = document.getElementById('loader-bar');
        intro.classList.add('active');
        setTimeout(() => bar.style.width = '100%', 100);
        setTimeout(() => {
            intro.classList.add('fade-out');
            document.getElementById('app-container').classList.add('visible');
            buildChatList();
            setTimeout(() => intro.style.display = 'none', 1200);
        }, 5500);
    }

    function getAvatarHTML(chat) {
        if (chat.img) {
            return `<div class="avatar" style="background-color:${chat.color}; color:${chat.textColor || 'white'}">
                        <img src="${chat.img}" onerror="this.style.display='none'; this.parentElement.innerText='${chat.initial}'">
                    </div>`;
        }
        return `<div class="avatar" style="background:${chat.color}; color:${chat.textColor || 'white'}">${chat.initial}</div>`;
    }

    function buildChatList() {
        const list = document.getElementById('chat-list-content');
        list.innerHTML = '';
        chatData.forEach(chat => {
            const item = document.createElement('div');
            item.className = 'chat-item';
            item.innerHTML = `
                ${getAvatarHTML(chat)}
                <div class="chat-preview">
                    <div class="chat-preview-top"><span class="name">${chat.name}</span><span class="chat-list-time">${getTimestamp()}</span></div>
                    <span class="sub">${chat.isVoice ? 'üé§ Sprachnachricht' : chat.sub}</span>
                </div>`;
            item.onclick = () => openChat(chat);
            list.appendChild(item);
        });
    }

    async function openChat(chat) {
        document.getElementById('listView').style.display = 'none';
        const detail = document.getElementById('detailView');
        detail.style.display = 'flex';
        setTimeout(() => detail.classList.add('view-active'), 50);
        
        const detailAvatar = document.getElementById('detail-avatar');
        document.getElementById('detail-name').innerText = chat.name;
        detailAvatar.innerHTML = chat.img ? `<img src="${chat.img}" onerror="this.style.display='none'; this.parentElement.innerText='${chat.initial}'">` : chat.initial;
        detailAvatar.style.backgroundColor = chat.color;
        
        const area = document.getElementById('message-area');
        area.innerHTML = '';
        const input = document.getElementById('chat-input');
        const sendBtn = document.getElementById('send-btn');
        input.value = ''; sendBtn.disabled = true;

        for (let i = 0; i < chat.initialMessages.length; i++) {
            document.getElementById('typing-box').classList.remove('hidden');
            await new Promise(r => setTimeout(r, 700 + Math.random() * 500));
            document.getElementById('typing-box').classList.add('hidden');
            
            const msgText = chat.initialMessages[i];
            if (msgText === "SHOW_PRODUCT_IMAGE") { addProductImage(); } 
            else if (msgText.includes("Future Times")) { addMediaLink(); } 
            else if (chat.isVoice && i === 0) { addVoiceBubble(chat); } 
            else { addMsg(msgText, 'bot'); }
            area.scrollTop = area.scrollHeight;
        }

        if (chat.options && chat.options[0]) {
            input.value = chat.options[0].t;
            sendBtn.disabled = false;
            sendBtn.onclick = () => handleSend(chat.options[0]);
        }
        if (window.umami) umami.track('Open Chat', { name: chat.name });
    }

    async function handleSend(option) {
        addMsg(option.t, 'user');
        document.getElementById('chat-input').value = '';
        document.getElementById('send-btn').disabled = true;
        setTimeout(async () => {
            document.getElementById('typing-box').classList.remove('hidden');
            await new Promise(r => setTimeout(r, 1400));
            document.getElementById('typing-box').classList.add('hidden');
            addMsg(option.r, 'bot');
        }, 500);
    }

    function addMsg(txt, type) {
        const area = document.getElementById('message-area');
        const div = document.createElement('div');
        div.className = `msg-wrapper ${type}`;
        div.innerHTML = `<div class="msg">${txt}</div><div class="timestamp">${getTimestamp()}</div>`;
        area.appendChild(div);
        area.scrollTop = area.scrollHeight;
    }

    function addProductImage() {
        const area = document.getElementById('message-area');
        const div = document.createElement('div');
        div.className = 'bot';
        div.innerHTML = `<div class="chat-img-bubble" onclick="openImageOverlay('aeroad.png')"><img src="aeroad.png"></div><div class="timestamp">${getTimestamp()}</div>`;
        area.appendChild(div);
        area.scrollTop = area.scrollHeight;
    }

    function addMediaLink() {
        const area = document.getElementById('message-area');
        const card = document.createElement('div');
        card.className = 'media-card';
        card.onclick = () => openWebOverlay('future-times-2.html');
        card.innerHTML = `<div class="media-img"></div><div class="media-info"><strong>Canyon verdoppelt Wert</strong></div>`;
        area.appendChild(card);
        area.scrollTop = area.scrollHeight;
    }

    function openWebOverlay(url) {
        document.getElementById('browser-iframe').src = url;
        document.getElementById('browser-iframe').style.display = 'block';
        document.getElementById('overlay-image').style.display = 'none';
        document.getElementById('browser-overlay').style.display = 'flex';
        if (window.umami) umami.track('View Article', { url: url });
    }

    function openImageOverlay(src) {
        document.getElementById('overlay-image').src = src;
        document.getElementById('overlay-image').style.display = 'block';
        document.getElementById('browser-iframe').style.display = 'none';
        document.getElementById('browser-overlay').style.display = 'flex';
    }

    function closeOverlay() {
        document.getElementById('browser-overlay').style.display = 'none';
        document.getElementById('browser-iframe').src = '';
    }

    function addVoiceBubble(chat) {
        const area = document.getElementById('message-area');
        const div = document.createElement('div');
        div.className = `msg-wrapper bot`;
        div.innerHTML = `<div class="voice-bubble" onclick="toggleAudio(this)"><button class="play-btn-circle">‚ñ∂</button></div>`;
        area.appendChild(div);
        area.scrollTop = area.scrollHeight;
    }

    function toggleAudio(container) {
        audioPlayer.src = 'BDC.wav';
        audioPlayer.play();
    }

    function closeChat() {
        document.getElementById('detailView').classList.remove('view-active');
        setTimeout(() => { 
            document.getElementById('detailView').style.display = 'none'; 
            document.getElementById('listView').style.display = 'block'; 
        }, 400);
    }

    startApp();
</script>
</body>
</html>